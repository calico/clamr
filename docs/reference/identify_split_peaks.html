<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Identify Split Peaks — identify_split_peaks • clamr</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Identify Split Peaks — identify_split_peaks"><meta property="og:description" content="Find split peaks where a single analyte is distributed across one or
more peakgroups."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">clamr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Identify Split Peaks</h1>
    
    <div class="hidden name"><code>identify_split_peaks.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Find split peaks where a single analyte is distributed across one or
more peakgroups.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">identify_split_peaks</span><span class="op">(</span>
  <span class="va">mzroll_db_con</span>,
  <span class="va">clamr_config</span>,
  max_rt_deviation <span class="op">=</span> <span class="fl">5</span>,
  ic_floor <span class="op">=</span> <span class="fl">2</span><span class="op">^</span><span class="fl">10</span>,
  anticorrelation_co <span class="op">=</span> <span class="op">-</span><span class="fl">0.1</span>,
  signal_frac_IQR_co <span class="op">=</span> <span class="fl">0.75</span>,
  spectra_corr_co <span class="op">=</span> <span class="fl">0.8</span>,
  stratify_regex <span class="op">=</span> <span class="cn">NULL</span>,
  n_top_spectra_summed <span class="op">=</span> <span class="fl">3L</span>,
  quality_weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>purity <span class="op">=</span> <span class="fl">2</span>, quality <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>mzroll_db_con</dt>
<dd><p>a connection to a mzroll database as produced by <code><a href="mzroll_db_sqlite.html">mzroll_db_sqlite</a></code></p></dd>
<dt>clamr_config</dt>
<dd><p>a named list of mass spec parameters with special formatting of instrument tolerances generated by <code><a href="build_clamr_config.html">build_clamr_config</a></code>.</p></dd>
<dt>max_rt_deviation</dt>
<dd><p>maximum rt deviation between two peakgroups which
could be the same analyte.</p></dd>
<dt>ic_floor</dt>
<dd><p>floor all low or missing signals to this value for the
purpose of calculating anti-correlation in log-space.</p></dd>
<dt>anticorrelation_co</dt>
<dd><p>cutoff for what is a strong anti-correlation as a
sign of peak splitting (most signal of some samples in group A and others in group B will induce a negative correlation between A and B).</p></dd>
<dt>signal_frac_IQR_co</dt>
<dd><p>cutoff for interquartile range of fractional
signal spread between candidate split peak pairs.</p></dd>
<dt>spectra_corr_co</dt>
<dd><p>cutoff for correlation between consensus spectra
of the two peakgroups.</p></dd>
<dt>stratify_regex</dt>
<dd><p>NULL for no stratification or a string regular
expression indicating categories which should drive peak splitting
(e.g., batch or date).</p></dd>
<dt>n_top_spectra_summed</dt>
<dd><p>integer counts of maximum number of spectra to aggregate</p></dd>
<dt>quality_weights</dt>
<dd><p>length 2 named vector with names "purity" and "quality" indicating the relative amount to weight by precursor purity (i.e., the amount of isolated signal matching the precursorMz) versus peak quality (i.e., good peak shapes).</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>a tibble containing two variables:</p><ul><li><p><code>groupId_old</code> - current groupIds in the mzroll_db_con</p></li>
<li><p><code>groupId_new</code> - updated groupIds in the mzroll_db_con</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>To be conservative, identified split peak pairs must satisfy all of the following conditions:</p><ul><li><p><code>mass agreement</code> - within the mass tolerance specified in the
    <code>clamr_config</code></p></li>
<li><p><code>retention time agreement</code> - RTs are within
    <code>max_rt_deviation</code> of one another</p></li>
<li><p><code>mutual exclusivity</code> - log-abundances must be anti-correlated
    beyond <code>anticorrelation_co</code> and inter-quartile range of the signal
    split fracitons (fraction of signal in A versus B: A / (A + B)) above
    <code>signal_frac_IQR_co</code>.</p></li>
<li><p><code>batch-driven</code> [optional] - if batches are provided (using
    <code>stratify_regex</code>) then signal fraction variation should be explained
    by batches.</p></li>
<li><p><code>fragmentation agreement</code> - fragmentation spectra are correlated above <code>spectra_corr_co</code></p></li>
</ul></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Sean Hackett, Phillip Seitzer.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer></div>

  


  

  </body></html>

