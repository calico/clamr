<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>MS2 Driven Aligner — ms2_driven_aligner • clamr</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="MS2 Driven Aligner — ms2_driven_aligner"><meta property="og:description" content="Across a dataset, use MS1 and MS2 data to generate update function which can be used to transform retention times and mass accuracy in order to improve consistency."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">clamr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>MS2 Driven Aligner</h1>
    
    <div class="hidden name"><code>ms2_driven_aligner.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Across a dataset, use MS1 and MS2 data to generate update function which can be used to transform retention times and mass accuracy in order to improve consistency.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">ms2_driven_aligner</span><span class="op">(</span>
  <span class="va">mzroll_db_con</span>,
  <span class="va">clamr_config</span>,
  group_by_charge <span class="op">=</span> <span class="cn">FALSE</span>,
  peak_quality_cutoff <span class="op">=</span> <span class="fl">0.5</span>,
  maximum_mz_set_size <span class="op">=</span> <span class="fl">1000</span>,
  cosine_cutoff <span class="op">=</span> <span class="fl">0.95</span>,
  sd_rt_resid_cutoff <span class="op">=</span> <span class="fl">0.1</span>,
  spline_ridge_penalty <span class="op">=</span> <span class="fl">200</span>,
  spline_degree <span class="op">=</span> <span class="fl">4L</span>,
  return_plot_data <span class="op">=</span> <span class="cn">FALSE</span>,
  quietly <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>mzroll_db_con</dt>
<dd><p>a connection to a mzroll database as produced by <code><a href="mzroll_db_sqlite.html">mzroll_db_sqlite</a></code></p></dd>
<dt>clamr_config</dt>
<dd><p>a named list of mass spec parameters with special formatting of instrument tolerances generated by <code><a href="build_clamr_config.html">build_clamr_config</a></code>.</p></dd>
<dt>group_by_charge</dt>
<dd><p>Require that peaks match in precursor charge in order to be a possible match -- discard all peaks with unknown charge.</p></dd>
<dt>peak_quality_cutoff</dt>
<dd><p>Minimum quality for a scan's matching peak for the ion to be used for alignment.</p></dd>
<dt>maximum_mz_set_size</dt>
<dd><p>The maximum number of possibly matching ms2 events that will be considered.</p></dd>
<dt>cosine_cutoff</dt>
<dd><p>Minimum cosine similarity between a pair of MS2 fragment profiles to group them into a common cluster.</p></dd>
<dt>sd_rt_resid_cutoff</dt>
<dd><p>Cutoff for excluding a compound based on the standard deviation of its residuals (rt - fitted rt): sd(resid)/range(rt) &lt; <code>sd_rt_resid_cutoff</code>.</p></dd>
<dt>spline_ridge_penalty</dt>
<dd><p>Ridge penalty on sample-level splines which model deviations between observed retention times and the consensus rt of a compound. Used for the H parameter in <a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a>.</p></dd>
<dt>spline_degree</dt>
<dd><p>Degree of spline used to estimate drift (integer).</p></dd>
<dt>return_plot_data</dt>
<dd><p>return data which can be used to plot alignment summaries with <code><a href="ms2_driven_aligner_plotting.html">ms2_driven_aligner_plotting</a></code></p></dd>
<dt>quietly</dt>
<dd><p>Hide messages and warnings</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>an update mzroll_db_con where all features have had a function applied of the form RT_updated = RT_original + g(RT_original), where the aim of the g(RT_original) is to estimate retention time deviations between individual samples and a consensus sample.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function uses MS1 and MS2 similarity to group MS2 events from different samples together and then determines the extent to which
individual samples systematically deviate in either retention time or mass accuracy.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="co"># TO DO - add a smaller dataset so this would run fast enough for testing</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">mzroll_db_con</span> <span class="op">&lt;-</span> <span class="fu">clamshell</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/clamshell/man/get_clamr_assets.html" class="external-link">get_clamr_assets</a></span><span class="op">(</span><span class="st">"mzkit_peakdetector.mzrollDB"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu"><a href="mzroll_db_sqlite.html">mzroll_db_sqlite</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">clamr_config</span> <span class="op">&lt;-</span> <span class="fu"><a href="build_clamr_config.html">build_clamr_config</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>MS1tol <span class="op">=</span> <span class="st">"10ppm"</span>, MS2tol <span class="op">=</span> <span class="st">"20ppm"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">ms2_driven_aligner</span><span class="op">(</span><span class="va">mzroll_db_con</span>, <span class="va">clamr_config</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Sean Hackett, Phillip Seitzer.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer></div>

  


  

  </body></html>

